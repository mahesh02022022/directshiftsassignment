{"ast":null,"code":"import _toConsumableArray from\"C:/ruby_prg/7/react-wishlist-series/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/ruby_prg/7/react-wishlist-series/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/ruby_prg/7/react-wishlist-series/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\ruby_prg\\\\7\\\\react-wishlist-series\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{Visibility,VisibilityOff}from\"@mui/icons-material\";import{Alert,Button,Card,CardContent,Container,FormControl,FormGroup,FormHelperText,IconButton,Input,InputAdornment,InputLabel,OutlinedInput,Typography}from\"@mui/material\";import{useEffect,useRef,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{resetErrorState,updateProfile}from\"./sessionSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UpdateProfile(){var emailRef=useRef();var emailConfirmationRef=useRef();var passwordRef=useRef();var passwordConfirmationRef=useRef();var currentPasswordRef=useRef();var accessToken=useSelector(function(state){return state.session.accessToken;});var errorMessages=useSelector(function(state){return state.session.errorMessages;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showPassword=_useState4[0],setShowPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showCurrentPassword=_useState6[0],setShowCurrentPassword=_useState6[1];var loading=false;var navigate=useNavigate();var dispatch=useDispatch();useEffect(function(){var _emailRef$current;emailRef===null||emailRef===void 0?void 0:(_emailRef$current=emailRef.current)===null||_emailRef$current===void 0?void 0:_emailRef$current.focus();if(errorMessages!==undefined){setErrors(errorMessages);dispatch(resetErrorState());}},[]);function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _emailRef$current2,_passwordRef$current,_currentPasswordRef$c,_emailRef$current4,_passwordRef$current3;var shouldUpdateEmail,shouldUpdatePassword,shouldUpdateProfile,_emailRef$current3,_emailConfirmationRef,_passwordRef$current2,_passwordConfirmation,payload,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();setErrors([]);shouldUpdateEmail=(emailRef===null||emailRef===void 0?void 0:emailRef.current)!==undefined&&(emailRef===null||emailRef===void 0?void 0:(_emailRef$current2=emailRef.current)===null||_emailRef$current2===void 0?void 0:_emailRef$current2.value)!==\"\";shouldUpdatePassword=(passwordRef===null||passwordRef===void 0?void 0:passwordRef.current)!==undefined&&(passwordRef===null||passwordRef===void 0?void 0:(_passwordRef$current=passwordRef.current)===null||_passwordRef$current===void 0?void 0:_passwordRef$current.value)!==\"\";shouldUpdateProfile=shouldUpdateEmail||shouldUpdatePassword;if(!shouldUpdateProfile){navigate(\"/\");}if(shouldUpdateEmail){if((emailRef===null||emailRef===void 0?void 0:(_emailRef$current3=emailRef.current)===null||_emailRef$current3===void 0?void 0:_emailRef$current3.value)!==(emailConfirmationRef===null||emailConfirmationRef===void 0?void 0:(_emailConfirmationRef=emailConfirmationRef.current)===null||_emailConfirmationRef===void 0?void 0:_emailConfirmationRef.value)){setErrors([\"Emails do not match\"]);}}if(shouldUpdatePassword){if((passwordRef===null||passwordRef===void 0?void 0:(_passwordRef$current2=passwordRef.current)===null||_passwordRef$current2===void 0?void 0:_passwordRef$current2.value)!==(passwordConfirmationRef===null||passwordConfirmationRef===void 0?void 0:(_passwordConfirmation=passwordConfirmationRef.current)===null||_passwordConfirmation===void 0?void 0:_passwordConfirmation.value)){setErrors(function(errors){return[].concat(_toConsumableArray(errors),[\"Passwords do not match\"]);});}}if((currentPasswordRef===null||currentPasswordRef===void 0?void 0:(_currentPasswordRef$c=currentPasswordRef.current)===null||_currentPasswordRef$c===void 0?void 0:_currentPasswordRef$c.value)===undefined||currentPasswordRef.current.value===\"\"){setErrors(function(errors){return[].concat(_toConsumableArray(errors),[\"Please enter your current password to confirm your changes\"]);});}if(!(errors.length>0)){_context.next=11;break;}return _context.abrupt(\"return\",errors);case 11:payload={email:emailRef===null||emailRef===void 0?void 0:(_emailRef$current4=emailRef.current)===null||_emailRef$current4===void 0?void 0:_emailRef$current4.value,token:accessToken,password:passwordRef===null||passwordRef===void 0?void 0:(_passwordRef$current3=passwordRef.current)===null||_passwordRef$current3===void 0?void 0:_passwordRef$current3.value,currentPassword:currentPasswordRef.current.value};_context.next=14;return dispatch(updateProfile(payload));case 14:response=_context.sent;console.log(response);if(!response.error){_context.next=20;break;}return _context.abrupt(\"return\",setErrors(response.error));case 20:navigate(\"/\");case 21:case\"end\":return _context.stop();}}},_callee);}));return _handleSubmit.apply(this,arguments);}var passwordInput=/*#__PURE__*/_jsx(OutlinedInput,{id:\"password\",type:showPassword?'text':'password',inputRef:passwordRef,endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"toggle password visibility\",onClick:function onClick(){return setShowPassword(!showPassword);},onMouseDown:function onMouseDown(){return setShowPassword(!showPassword);},edge:\"end\",children:showPassword?/*#__PURE__*/_jsx(Visibility,{}):/*#__PURE__*/_jsx(VisibilityOff,{})})})});var passwordConfirmationInput=/*#__PURE__*/_jsx(OutlinedInput,{id:\"password-confirmation\",type:showPassword?'text':'password',inputRef:passwordConfirmationRef,endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"toggle password visibility\",onClick:function onClick(){return setShowPassword(!showPassword);},onMouseDown:function onMouseDown(){return setShowPassword(!showPassword);},edge:\"end\",children:showPassword?/*#__PURE__*/_jsx(Visibility,{}):/*#__PURE__*/_jsx(VisibilityOff,{})})})});var currentPasswordInput=/*#__PURE__*/_jsx(OutlinedInput,{id:\"current-password-confirmation\",type:showCurrentPassword?'text':'password',inputRef:currentPasswordRef,endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"toggle password visibility\",onClick:function onClick(){return setShowCurrentPassword(!showCurrentPassword);},onMouseDown:function onMouseDown(){return setShowCurrentPassword(!showCurrentPassword);},edge:\"end\",children:showCurrentPassword?/*#__PURE__*/_jsx(Visibility,{}):/*#__PURE__*/_jsx(VisibilityOff,{})})})});return/*#__PURE__*/_jsx(\"section\",{style:{marginTop:\"2em\"},children:/*#__PURE__*/_jsx(Container,{maxWidth:\"md\",children:/*#__PURE__*/_jsx(Card,{sx:{boxShadow:1,maxWidth:'md'},children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Container,{maxWidth:\"sm\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h2\",color:\"text.primary\",gutterBottom:true,children:\"Update Profile\"}),errors.length>0?/*#__PURE__*/_jsx(Alert,{severity:\"error\",\"aria-live\":\"assertive\",children:errors.map(function(error,index){return/*#__PURE__*/_jsx(\"p\",{children:error},\"alert-\".concat(index));})}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"email-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"email\",id:\"email-label\",children:\"Email Address\"}),/*#__PURE__*/_jsx(Input,{id:\"email\",type:\"email\",inputRef:emailRef}),/*#__PURE__*/_jsx(FormHelperText,{id:\"email-helper-text\",children:\"Enter current email\"})]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"email-confirmation-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"email-confirmation\",id:\"email-confirmation-label\",children:\"Email Address Confirmation\"}),/*#__PURE__*/_jsx(Input,{id:\"email-confirmation\",type:\"email\",inputRef:emailConfirmationRef}),/*#__PURE__*/_jsx(FormHelperText,{id:\"email-confirmation-helper-text\",children:\"Enter new email again\"})]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"password-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"password\",id:\"password-label\",children:\"Password\"}),passwordInput]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"password-confirmation-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"password-confirmation\",id:\"password-confirmation-label\",children:\"Password Confirmation\"}),passwordConfirmationInput]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"current-password-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{required:true,htmlFor:\"current-password\",id:\"current-password-label\",children:\"Current Password\"}),currentPasswordInput]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"submit-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsx(FormControl,{fullWidth:true,children:/*#__PURE__*/_jsx(Button,{disabled:loading,variant:\"contained\",color:\"primary\",type:\"submit\",id:\"submit-button\",children:\"Save Changes\"})})})]})]})})})})});}export default UpdateProfile;","map":{"version":3,"sources":["C:/ruby_prg/7/react-wishlist-series/frontend/src/app/features/sessions/UpdateProfile.tsx"],"names":["Visibility","VisibilityOff","Alert","Button","Card","CardContent","Container","FormControl","FormGroup","FormHelperText","IconButton","Input","InputAdornment","InputLabel","OutlinedInput","Typography","useEffect","useRef","useState","useDispatch","useSelector","useNavigate","resetErrorState","updateProfile","UpdateProfile","emailRef","emailConfirmationRef","passwordRef","passwordConfirmationRef","currentPasswordRef","accessToken","state","session","errorMessages","errors","setErrors","showPassword","setShowPassword","showCurrentPassword","setShowCurrentPassword","loading","navigate","dispatch","current","focus","undefined","handleSubmit","event","preventDefault","shouldUpdateEmail","value","shouldUpdatePassword","shouldUpdateProfile","length","payload","email","token","password","currentPassword","response","console","log","error","passwordInput","passwordConfirmationInput","currentPasswordInput","marginTop","boxShadow","maxWidth","map","index"],"mappings":"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","sourcesContent":["import { Visibility, VisibilityOff } from \"@mui/icons-material\";\r\nimport { Alert, Box, Button, Card, CardActions, CardContent, Container, Divider, FormControl, FormGroup, FormHelperText, IconButton, Input, InputAdornment, InputLabel, OutlinedInput, Typography } from \"@mui/material\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport { RootState } from \"../../store\";\r\nimport { resetErrorState, signUpUser, updateProfile } from \"./sessionSlice\";\r\n\r\n\r\nfunction UpdateProfile() {\r\n  const emailRef = useRef<HTMLInputElement>();\r\n  const emailConfirmationRef = useRef<HTMLInputElement>();\r\n  const passwordRef = useRef<HTMLInputElement>();\r\n  const passwordConfirmationRef = useRef<HTMLInputElement>();\r\n  const currentPasswordRef = useRef<HTMLInputElement>();\r\n\r\n  const accessToken = useSelector((state: RootState) => state.session.accessToken);\r\n  const errorMessages = useSelector((state: RootState) => state.session.errorMessages);\r\n\r\n  const [errors, setErrors] = useState<Array<string>>([])\r\n  const [showPassword, setShowPassword] = useState<boolean>(false);\r\n  const [showCurrentPassword, setShowCurrentPassword] = useState<boolean>(false);\r\n  const loading = false;\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    emailRef?.current?.focus();\r\n    if (errorMessages !== undefined) {\r\n      setErrors(errorMessages);\r\n      dispatch(resetErrorState());\r\n    }\r\n  }, [])\r\n\r\n  async function handleSubmit(event: React.FormEvent<HTMLFormElement>) {\r\n    event.preventDefault();\r\n    setErrors([]);\r\n    const shouldUpdateEmail = emailRef?.current !== undefined && emailRef?.current?.value !== \"\";\r\n    const shouldUpdatePassword = passwordRef?.current !== undefined && passwordRef?.current?.value !== \"\";\r\n    const shouldUpdateProfile = shouldUpdateEmail || shouldUpdatePassword;\r\n    if (!shouldUpdateProfile) {\r\n      navigate(\"/\");\r\n    }\r\n    if (shouldUpdateEmail) {\r\n      if (emailRef?.current?.value !== emailConfirmationRef?.current?.value) {\r\n        setErrors([\"Emails do not match\"])\r\n      }\r\n    }\r\n\r\n    if (shouldUpdatePassword) {\r\n      if (passwordRef?.current?.value !== passwordConfirmationRef?.current?.value) {\r\n        setErrors(errors => [...errors, \"Passwords do not match\"])\r\n      }\r\n    }\r\n    if (currentPasswordRef?.current?.value === undefined || currentPasswordRef.current.value === \"\") {\r\n      setErrors(errors => [...errors, \"Please enter your current password to confirm your changes\"])\r\n    }\r\n    if (errors.length > 0) {\r\n      return errors;\r\n    }\r\n\r\n    const payload = {\r\n      email: emailRef?.current?.value,\r\n      token: accessToken,\r\n      password: passwordRef?.current?.value,\r\n      currentPassword: currentPasswordRef!.current!.value\r\n    }\r\n    const response = await dispatch(updateProfile(payload)) as any;\r\n\r\n    console.log(response);\r\n    if (response.error) {\r\n      return setErrors(response.error);\r\n    } else {\r\n      navigate(\"/\")\r\n    }\r\n  }\r\n\r\n  const passwordInput = <OutlinedInput id=\"password\" type={showPassword ? 'text' : 'password'} inputRef={passwordRef} endAdornment={\r\n    <InputAdornment position=\"end\">\r\n      <IconButton\r\n        aria-label=\"toggle password visibility\"\r\n        onClick={() => setShowPassword(!showPassword)}\r\n        onMouseDown={() => setShowPassword(!showPassword)}\r\n        edge=\"end\">\r\n          {showPassword ? <Visibility /> : <VisibilityOff />}\r\n      </IconButton>\r\n    </InputAdornment>\r\n  } />;\r\n\r\n  const passwordConfirmationInput = <OutlinedInput id=\"password-confirmation\" type={showPassword ? 'text' : 'password'} inputRef={passwordConfirmationRef} endAdornment={\r\n    <InputAdornment position=\"end\">\r\n      <IconButton\r\n        aria-label=\"toggle password visibility\"\r\n        onClick={() => setShowPassword(!showPassword)}\r\n        onMouseDown={() => setShowPassword(!showPassword)}\r\n        edge=\"end\">\r\n          {showPassword ? <Visibility /> : <VisibilityOff />}\r\n      </IconButton>\r\n    </InputAdornment>\r\n  } />;\r\n\r\n  const currentPasswordInput = <OutlinedInput \r\n  id=\"current-password-confirmation\" \r\n  type={showCurrentPassword ? 'text' : 'password'} \r\n  inputRef={currentPasswordRef} \r\n  endAdornment={\r\n    <InputAdornment position=\"end\">\r\n      <IconButton\r\n        aria-label=\"toggle password visibility\"\r\n        onClick={() => setShowCurrentPassword(!showCurrentPassword)}\r\n        onMouseDown={() => setShowCurrentPassword(!showCurrentPassword)}\r\n        edge=\"end\">\r\n          {showCurrentPassword ? <Visibility /> : <VisibilityOff />}\r\n      </IconButton>\r\n    </InputAdornment>\r\n  } />;\r\n\r\n  return (\r\n    <section style={{marginTop:\"2em\"}}>\r\n      <Container maxWidth=\"md\">\r\n        <Card sx={{boxShadow:1, maxWidth: 'md'}}>\r\n          <CardContent>\r\n            <Container maxWidth=\"sm\">\r\n              <Typography variant=\"h2\" color=\"text.primary\" gutterBottom>\r\n                Update Profile\r\n              </Typography>\r\n              {errors.length > 0 ?\r\n                <Alert severity=\"error\" aria-live=\"assertive\">\r\n                  {errors.map((error, index) => {\r\n                    return <p key={`alert-${index}`}>\r\n                      {error}\r\n                    </p>\r\n                  })}\r\n                </Alert>\r\n              : <></>} \r\n              <form onSubmit={handleSubmit}>\r\n                <FormGroup row={true} id=\"email-group\" sx={{marginTop: \"1em\"}}>\r\n                  <FormControl fullWidth>\r\n                    <InputLabel htmlFor=\"email\" id=\"email-label\">Email Address</InputLabel>\r\n                    <Input id=\"email\" type=\"email\" inputRef={emailRef}/>\r\n                    <FormHelperText id=\"email-helper-text\">Enter current email</FormHelperText>\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup row={true} id=\"email-confirmation-group\" sx={{marginTop: \"1em\"}}>\r\n                  <FormControl fullWidth>\r\n                    <InputLabel htmlFor=\"email-confirmation\" id=\"email-confirmation-label\">Email Address Confirmation</InputLabel>\r\n                    <Input id=\"email-confirmation\" type=\"email\" inputRef={emailConfirmationRef}/>\r\n                    <FormHelperText id=\"email-confirmation-helper-text\">Enter new email again</FormHelperText>\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup row={true} id=\"password-group\" sx={{marginTop: \"1em\"}}>\r\n                  <FormControl fullWidth>\r\n                    <InputLabel htmlFor=\"password\" id=\"password-label\">Password</InputLabel>\r\n                    {passwordInput}\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup row={true} id=\"password-confirmation-group\" sx={{marginTop: \"1em\"}}>\r\n                  <FormControl fullWidth>\r\n                    <InputLabel htmlFor=\"password-confirmation\" id=\"password-confirmation-label\">Password Confirmation</InputLabel>\r\n                    {passwordConfirmationInput}\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup row={true} id=\"current-password-group\" sx={{marginTop: \"1em\"}}>\r\n                  <FormControl fullWidth>\r\n                    <InputLabel required htmlFor=\"current-password\" id=\"current-password-label\">Current Password</InputLabel>\r\n                    {currentPasswordInput}\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup row={true} id=\"submit-group\" sx={{marginTop: \"1em\"}}>\r\n                  <FormControl fullWidth>\r\n                    <Button \r\n                      disabled={loading} \r\n                      variant=\"contained\" \r\n                      color=\"primary\" \r\n                      type=\"submit\" \r\n                      id=\"submit-button\">Save Changes</Button>\r\n                  </FormControl>\r\n                </FormGroup>\r\n              </form>\r\n            </Container>\r\n          </CardContent>\r\n        </Card>\r\n      </Container>\r\n\r\n    </section>\r\n  )\r\n}\r\n\r\nexport default UpdateProfile"]},"metadata":{},"sourceType":"module"}