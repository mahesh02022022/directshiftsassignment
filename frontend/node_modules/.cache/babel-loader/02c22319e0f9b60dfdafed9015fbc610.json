{"ast":null,"code":"import _toConsumableArray from\"C:/ruby_prg/7/react-wishlist-series/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"C:/ruby_prg/7/react-wishlist-series/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/ruby_prg/7/react-wishlist-series/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\ruby_prg\\\\7\\\\react-wishlist-series\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{Visibility,VisibilityOff}from\"@mui/icons-material\";import{Alert,Button,Card,CardContent,Container,FormControl,FormGroup,FormHelperText,IconButton,Input,InputAdornment,InputLabel,OutlinedInput,Typography}from\"@mui/material\";import{useEffect,useRef,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{resetErrorState,updateProfile}from\"./sessionSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UpdateProfile(){var emailRef=useRef();var emailConfirmationRef=useRef();var passwordRef=useRef();var passwordConfirmationRef=useRef();var currentPasswordRef=useRef();var accessToken=useSelector(function(state){return state.session.accessToken;});var errorMessages=useSelector(function(state){return state.session.errorMessages;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showPassword=_useState4[0],setShowPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showCurrentPassword=_useState6[0],setShowCurrentPassword=_useState6[1];var loading=false;var navigate=useNavigate();var dispatch=useDispatch();useEffect(function(){var _emailRef$current;emailRef===null||emailRef===void 0?void 0:(_emailRef$current=emailRef.current)===null||_emailRef$current===void 0?void 0:_emailRef$current.focus();if(errorMessages!==undefined){setErrors(errorMessages);dispatch(resetErrorState());}},[]);function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var _emailRef$current2,_passwordRef$current,_currentPasswordRef$c,_emailRef$current4,_passwordRef$current3;var shouldUpdateEmail,shouldUpdatePassword,shouldUpdateProfile,_emailRef$current3,_emailConfirmationRef,_passwordRef$current2,_passwordConfirmation,payload,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();setErrors([]);shouldUpdateEmail=(emailRef===null||emailRef===void 0?void 0:emailRef.current)!==undefined&&(emailRef===null||emailRef===void 0?void 0:(_emailRef$current2=emailRef.current)===null||_emailRef$current2===void 0?void 0:_emailRef$current2.value)!==\"\";shouldUpdatePassword=(passwordRef===null||passwordRef===void 0?void 0:passwordRef.current)!==undefined&&(passwordRef===null||passwordRef===void 0?void 0:(_passwordRef$current=passwordRef.current)===null||_passwordRef$current===void 0?void 0:_passwordRef$current.value)!==\"\";shouldUpdateProfile=shouldUpdateEmail||shouldUpdatePassword;if(!shouldUpdateProfile){navigate(\"/\");}if(shouldUpdateEmail){if((emailRef===null||emailRef===void 0?void 0:(_emailRef$current3=emailRef.current)===null||_emailRef$current3===void 0?void 0:_emailRef$current3.value)!==(emailConfirmationRef===null||emailConfirmationRef===void 0?void 0:(_emailConfirmationRef=emailConfirmationRef.current)===null||_emailConfirmationRef===void 0?void 0:_emailConfirmationRef.value)){setErrors([\"Emails do not match\"]);}}if(shouldUpdatePassword){if((passwordRef===null||passwordRef===void 0?void 0:(_passwordRef$current2=passwordRef.current)===null||_passwordRef$current2===void 0?void 0:_passwordRef$current2.value)!==(passwordConfirmationRef===null||passwordConfirmationRef===void 0?void 0:(_passwordConfirmation=passwordConfirmationRef.current)===null||_passwordConfirmation===void 0?void 0:_passwordConfirmation.value)){setErrors(function(errors){return[].concat(_toConsumableArray(errors),[\"Passwords do not match\"]);});}}if((currentPasswordRef===null||currentPasswordRef===void 0?void 0:(_currentPasswordRef$c=currentPasswordRef.current)===null||_currentPasswordRef$c===void 0?void 0:_currentPasswordRef$c.value)===undefined||currentPasswordRef.current.value===\"\"){setErrors(function(errors){return[].concat(_toConsumableArray(errors),[\"Please enter your current password to confirm your changes\"]);});}if(!(errors.length>0)){_context.next=11;break;}return _context.abrupt(\"return\",errors);case 11:payload={email:emailRef===null||emailRef===void 0?void 0:(_emailRef$current4=emailRef.current)===null||_emailRef$current4===void 0?void 0:_emailRef$current4.value,token:accessToken,password:passwordRef===null||passwordRef===void 0?void 0:(_passwordRef$current3=passwordRef.current)===null||_passwordRef$current3===void 0?void 0:_passwordRef$current3.value,currentPassword:currentPasswordRef.current.value};_context.next=14;return dispatch(updateProfile(payload));case 14:response=_context.sent;console.log(response);if(!response.error){_context.next=20;break;}return _context.abrupt(\"return\",setErrors(response.error));case 20:navigate(\"/\");case 21:case\"end\":return _context.stop();}}},_callee);}));return _handleSubmit.apply(this,arguments);}var passwordInput=/*#__PURE__*/_jsx(OutlinedInput,{id:\"password\",label:\"Password\",variant:\"Password\",type:showPassword?\"text\":\"password\",inputRef:passwordRef,endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"toggle password visibility\",onClick:function onClick(){return setShowPassword(!showPassword);},onMouseDown:function onMouseDown(){return setShowPassword(!showPassword);},edge:\"end\",children:showPassword?/*#__PURE__*/_jsx(Visibility,{}):/*#__PURE__*/_jsx(VisibilityOff,{})})})});var passwordConfirmationInput=/*#__PURE__*/_jsx(OutlinedInput,{id:\"password-confirmation\",label:\"Password Confirmation\",variant:\"Password Confirmation\",type:showPassword?\"text\":\"password\",inputRef:passwordConfirmationRef,endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"toggle password visibility\",onClick:function onClick(){return setShowPassword(!showPassword);},onMouseDown:function onMouseDown(){return setShowPassword(!showPassword);},edge:\"end\",children:showPassword?/*#__PURE__*/_jsx(Visibility,{}):/*#__PURE__*/_jsx(VisibilityOff,{})})})});var currentPasswordInput=/*#__PURE__*/_jsx(OutlinedInput,{id:\"current-password-confirmation\",label:\"Current Password\",variant:\"Current Password\",type:showCurrentPassword?\"text\":\"password\",inputRef:currentPasswordRef,endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"toggle password visibility\",onClick:function onClick(){return setShowCurrentPassword(!showCurrentPassword);},onMouseDown:function onMouseDown(){return setShowCurrentPassword(!showCurrentPassword);},edge:\"end\",children:showCurrentPassword?/*#__PURE__*/_jsx(Visibility,{}):/*#__PURE__*/_jsx(VisibilityOff,{})})})});return/*#__PURE__*/_jsx(\"section\",{style:{marginTop:\"2em\"},children:/*#__PURE__*/_jsx(Container,{maxWidth:\"md\",children:/*#__PURE__*/_jsx(Card,{sx:{boxShadow:1,maxWidth:\"md\"},children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Container,{maxWidth:\"sm\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h2\",color:\"text.primary\",gutterBottom:true,children:\"Update Profile\"}),errors.length>0?/*#__PURE__*/_jsx(Alert,{severity:\"error\",\"aria-live\":\"assertive\",children:errors.map(function(error,index){return/*#__PURE__*/_jsx(\"p\",{children:error},\"alert-\".concat(index));})}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"email-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"email\",id:\"email-label\",children:\"Email Address\"}),/*#__PURE__*/_jsx(Input,{id:\"email\",type:\"email\",inputRef:emailRef}),/*#__PURE__*/_jsx(FormHelperText,{id:\"email-helper-text\",children:\"Enter current email\"})]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"email-confirmation-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"email-confirmation\",id:\"email-confirmation-label\",children:\"Email Address Confirmation\"}),/*#__PURE__*/_jsx(Input,{id:\"email-confirmation\",type:\"email\",inputRef:emailConfirmationRef}),/*#__PURE__*/_jsx(FormHelperText,{id:\"email-confirmation-helper-text\",children:\"Enter new email again\"})]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"password-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"password\",id:\"password-label\",children:\"Password\"}),passwordInput]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"password-confirmation-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{htmlFor:\"password-confirmation\",id:\"password-confirmation-label\",children:\"Password Confirmation\"}),passwordConfirmationInput]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"current-password-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{required:true,htmlFor:\"current-password\",id:\"current-password-label\",children:\"Current Password\"}),currentPasswordInput]})}),/*#__PURE__*/_jsx(FormGroup,{row:true,id:\"submit-group\",sx:{marginTop:\"1em\"},children:/*#__PURE__*/_jsx(FormControl,{fullWidth:true,children:/*#__PURE__*/_jsx(Button,{disabled:loading,variant:\"contained\",color:\"primary\",type:\"submit\",id:\"submit-button\",children:\"Save Changes\"})})})]})]})})})})});}export default UpdateProfile;","map":{"version":3,"sources":["C:/ruby_prg/7/react-wishlist-series/frontend/src/app/features/sessions/UpdateProfile.tsx"],"names":["Visibility","VisibilityOff","Alert","Button","Card","CardContent","Container","FormControl","FormGroup","FormHelperText","IconButton","Input","InputAdornment","InputLabel","OutlinedInput","Typography","useEffect","useRef","useState","useDispatch","useSelector","useNavigate","resetErrorState","updateProfile","UpdateProfile","emailRef","emailConfirmationRef","passwordRef","passwordConfirmationRef","currentPasswordRef","accessToken","state","session","errorMessages","errors","setErrors","showPassword","setShowPassword","showCurrentPassword","setShowCurrentPassword","loading","navigate","dispatch","current","focus","undefined","handleSubmit","event","preventDefault","shouldUpdateEmail","value","shouldUpdatePassword","shouldUpdateProfile","length","payload","email","token","password","currentPassword","response","console","log","error","passwordInput","passwordConfirmationInput","currentPasswordInput","marginTop","boxShadow","maxWidth","map","index"],"mappings":"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","sourcesContent":["import { Visibility, VisibilityOff } from \"@mui/icons-material\";\r\nimport {\r\n  Alert,\r\n  Box,\r\n  Button,\r\n  Card,\r\n  CardActions,\r\n  CardContent,\r\n  Container,\r\n  Divider,\r\n  FormControl,\r\n  FormGroup,\r\n  FormHelperText,\r\n  IconButton,\r\n  Input,\r\n  InputAdornment,\r\n  InputLabel,\r\n  OutlinedInput,\r\n  Typography,\r\n} from \"@mui/material\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport { RootState } from \"../../store\";\r\nimport { resetErrorState, signUpUser, updateProfile } from \"./sessionSlice\";\r\n\r\nfunction UpdateProfile() {\r\n  const emailRef = useRef<HTMLInputElement>();\r\n  const emailConfirmationRef = useRef<HTMLInputElement>();\r\n  const passwordRef = useRef<HTMLInputElement>();\r\n  const passwordConfirmationRef = useRef<HTMLInputElement>();\r\n  const currentPasswordRef = useRef<HTMLInputElement>();\r\n\r\n  const accessToken = useSelector(\r\n    (state: RootState) => state.session.accessToken\r\n  );\r\n  const errorMessages = useSelector(\r\n    (state: RootState) => state.session.errorMessages\r\n  );\r\n\r\n  const [errors, setErrors] = useState<Array<string>>([]);\r\n  const [showPassword, setShowPassword] = useState<boolean>(false);\r\n  const [showCurrentPassword, setShowCurrentPassword] =\r\n    useState<boolean>(false);\r\n  const loading = false;\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    emailRef?.current?.focus();\r\n    if (errorMessages !== undefined) {\r\n      setErrors(errorMessages);\r\n      dispatch(resetErrorState());\r\n    }\r\n  }, []);\r\n\r\n  async function handleSubmit(event: React.FormEvent<HTMLFormElement>) {\r\n    event.preventDefault();\r\n    setErrors([]);\r\n    const shouldUpdateEmail =\r\n      emailRef?.current !== undefined && emailRef?.current?.value !== \"\";\r\n    const shouldUpdatePassword =\r\n      passwordRef?.current !== undefined && passwordRef?.current?.value !== \"\";\r\n    const shouldUpdateProfile = shouldUpdateEmail || shouldUpdatePassword;\r\n    if (!shouldUpdateProfile) {\r\n      navigate(\"/\");\r\n    }\r\n    if (shouldUpdateEmail) {\r\n      if (emailRef?.current?.value !== emailConfirmationRef?.current?.value) {\r\n        setErrors([\"Emails do not match\"]);\r\n      }\r\n    }\r\n\r\n    if (shouldUpdatePassword) {\r\n      if (\r\n        passwordRef?.current?.value !== passwordConfirmationRef?.current?.value\r\n      ) {\r\n        setErrors((errors) => [...errors, \"Passwords do not match\"]);\r\n      }\r\n    }\r\n    if (\r\n      currentPasswordRef?.current?.value === undefined ||\r\n      currentPasswordRef.current.value === \"\"\r\n    ) {\r\n      setErrors((errors) => [\r\n        ...errors,\r\n        \"Please enter your current password to confirm your changes\",\r\n      ]);\r\n    }\r\n    if (errors.length > 0) {\r\n      return errors;\r\n    }\r\n\r\n    const payload = {\r\n      email: emailRef?.current?.value,\r\n      token: accessToken,\r\n      password: passwordRef?.current?.value,\r\n      currentPassword: currentPasswordRef!.current!.value,\r\n    };\r\n    const response = (await dispatch(updateProfile(payload))) as any;\r\n\r\n    console.log(response);\r\n    if (response.error) {\r\n      return setErrors(response.error);\r\n    } else {\r\n      navigate(\"/\");\r\n    }\r\n  }\r\n\r\n  const passwordInput = (\r\n    <OutlinedInput\r\n      id=\"password\"\r\n      label=\"Password\"\r\n      variant=\"Password\"\r\n      type={showPassword ? \"text\" : \"password\"}\r\n      inputRef={passwordRef}\r\n      endAdornment={\r\n        <InputAdornment position=\"end\">\r\n          <IconButton\r\n            aria-label=\"toggle password visibility\"\r\n            onClick={() => setShowPassword(!showPassword)}\r\n            onMouseDown={() => setShowPassword(!showPassword)}\r\n            edge=\"end\"\r\n          >\r\n            {showPassword ? <Visibility /> : <VisibilityOff />}\r\n          </IconButton>\r\n        </InputAdornment>\r\n      }\r\n    />\r\n  );\r\n\r\n  const passwordConfirmationInput = (\r\n    <OutlinedInput\r\n      id=\"password-confirmation\"\r\n      label=\"Password Confirmation\"\r\n      variant=\"Password Confirmation\"\r\n      type={showPassword ? \"text\" : \"password\"}\r\n      inputRef={passwordConfirmationRef}\r\n      endAdornment={\r\n        <InputAdornment position=\"end\">\r\n          <IconButton\r\n            aria-label=\"toggle password visibility\"\r\n            onClick={() => setShowPassword(!showPassword)}\r\n            onMouseDown={() => setShowPassword(!showPassword)}\r\n            edge=\"end\"\r\n          >\r\n            {showPassword ? <Visibility /> : <VisibilityOff />}\r\n          </IconButton>\r\n        </InputAdornment>\r\n      }\r\n    />\r\n  );\r\n\r\n  const currentPasswordInput = (\r\n    <OutlinedInput\r\n      id=\"current-password-confirmation\"\r\n      label=\"Current Password\"\r\n      variant=\"Current Password\"\r\n      type={showCurrentPassword ? \"text\" : \"password\"}\r\n      inputRef={currentPasswordRef}\r\n      endAdornment={\r\n        <InputAdornment position=\"end\">\r\n          <IconButton\r\n            aria-label=\"toggle password visibility\"\r\n            onClick={() => setShowCurrentPassword(!showCurrentPassword)}\r\n            onMouseDown={() => setShowCurrentPassword(!showCurrentPassword)}\r\n            edge=\"end\"\r\n          >\r\n            {showCurrentPassword ? <Visibility /> : <VisibilityOff />}\r\n          </IconButton>\r\n        </InputAdornment>\r\n      }\r\n    />\r\n  );\r\n\r\n  return (\r\n    <section style={{ marginTop: \"2em\" }}>\r\n      <Container maxWidth=\"md\">\r\n        <Card sx={{ boxShadow: 1, maxWidth: \"md\" }}>\r\n          <CardContent>\r\n            <Container maxWidth=\"sm\">\r\n              <Typography variant=\"h2\" color=\"text.primary\" gutterBottom>\r\n                Update Profile\r\n              </Typography>\r\n              {errors.length > 0 ? (\r\n                <Alert severity=\"error\" aria-live=\"assertive\">\r\n                  {errors.map((error, index) => {\r\n                    return <p key={`alert-${index}`}>{error}</p>;\r\n                  })}\r\n                </Alert>\r\n              ) : (\r\n                <></>\r\n              )}\r\n              <form onSubmit={handleSubmit}>\r\n                <FormGroup\r\n                  row={true}\r\n                  id=\"email-group\"\r\n                  sx={{ marginTop: \"1em\" }}\r\n                >\r\n                  <FormControl fullWidth>\r\n                    <InputLabel htmlFor=\"email\" id=\"email-label\">\r\n                      Email Address\r\n                    </InputLabel>\r\n                    <Input id=\"email\" type=\"email\" inputRef={emailRef} />\r\n                    <FormHelperText id=\"email-helper-text\">\r\n                      Enter current email\r\n                    </FormHelperText>\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup\r\n                  row={true}\r\n                  id=\"email-confirmation-group\"\r\n                  sx={{ marginTop: \"1em\" }}\r\n                >\r\n                  <FormControl fullWidth>\r\n                    <InputLabel\r\n                      htmlFor=\"email-confirmation\"\r\n                      id=\"email-confirmation-label\"\r\n                    >\r\n                      Email Address Confirmation\r\n                    </InputLabel>\r\n                    <Input\r\n                      id=\"email-confirmation\"\r\n                      type=\"email\"\r\n                      inputRef={emailConfirmationRef}\r\n                    />\r\n                    <FormHelperText id=\"email-confirmation-helper-text\">\r\n                      Enter new email again\r\n                    </FormHelperText>\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup\r\n                  row={true}\r\n                  id=\"password-group\"\r\n                  sx={{ marginTop: \"1em\" }}\r\n                >\r\n                  <FormControl fullWidth>\r\n                    <InputLabel htmlFor=\"password\" id=\"password-label\">\r\n                      Password\r\n                    </InputLabel>\r\n                    {passwordInput}\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup\r\n                  row={true}\r\n                  id=\"password-confirmation-group\"\r\n                  sx={{ marginTop: \"1em\" }}\r\n                >\r\n                  <FormControl fullWidth>\r\n                    <InputLabel\r\n                      htmlFor=\"password-confirmation\"\r\n                      id=\"password-confirmation-label\"\r\n                    >\r\n                      Password Confirmation\r\n                    </InputLabel>\r\n                    {passwordConfirmationInput}\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup\r\n                  row={true}\r\n                  id=\"current-password-group\"\r\n                  sx={{ marginTop: \"1em\" }}\r\n                >\r\n                  <FormControl fullWidth>\r\n                    <InputLabel\r\n                      required\r\n                      htmlFor=\"current-password\"\r\n                      id=\"current-password-label\"\r\n                    >\r\n                      Current Password\r\n                    </InputLabel>\r\n                    {currentPasswordInput}\r\n                  </FormControl>\r\n                </FormGroup>\r\n                <FormGroup\r\n                  row={true}\r\n                  id=\"submit-group\"\r\n                  sx={{ marginTop: \"1em\" }}\r\n                >\r\n                  <FormControl fullWidth>\r\n                    <Button\r\n                      disabled={loading}\r\n                      variant=\"contained\"\r\n                      color=\"primary\"\r\n                      type=\"submit\"\r\n                      id=\"submit-button\"\r\n                    >\r\n                      Save Changes\r\n                    </Button>\r\n                  </FormControl>\r\n                </FormGroup>\r\n              </form>\r\n            </Container>\r\n          </CardContent>\r\n        </Card>\r\n      </Container>\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default UpdateProfile;\r\n"]},"metadata":{},"sourceType":"module"}